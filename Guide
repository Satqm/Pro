I understand the issue. When you manually enter hours for a topic/subtopic, but then mark it as "Completed", the system is overwriting your manual hours with weightage-based calculations. I'll provide the fix with clear instructions.

Step-by-Step Fix Instructions:

Step 1: Find and Delete the OLD Code in toggleTopicStatus function

1. Look for this exact code block (around line 1820-1890 in your file):

```javascript
if (nextStatus === 'completed') {
    // Find topic data from syllabus to get weightage
    const subjectData = syllabusData[subjectId];
    const syllabusTopic = subjectData.topics.find(t => t.name === topicName);
    
    if (syllabusTopic) {
        // Calculate topic planned hours based on subject distribution
        const subjectPlannedHours = userStudyPlan?.subjectHours?.[subjectId] || 0;
        const topicWeightage = syllabusTopic.weightage;
        const topicPlannedHours = (topicWeightage / 100) * subjectPlannedHours;
        
        Object.keys(topic.subtopics).forEach(subtopicName => {
            const subtopic = topic.subtopics[subtopicName];
            
            // IMPORTANT: Only auto-calculate hours if user hasn't entered ANY hours
            // (actualHours is 0 or doesn't exist)
            if (!subtopic.actualHours || subtopic.actualHours === 0) {
                // Find subtopic data to get its weight
                const subtopicData = syllabusTopic.subtopics.find(s => s.name === subtopicName);
                if (subtopicData) {
                    const subtopicWeightage = subtopicData.weight;
                    // Calculate hours: subtopic weight * topic planned hours
                    subtopic.actualHours = (subtopicWeightage / 100) * topicPlannedHours;
                } else {
                    // Fallback: distribute equally
                    const numSubtopics = Object.keys(topic.subtopics).length;
                    subtopic.actualHours = topicPlannedHours / numSubtopics;
                }
                subtopic.completed = true;
            } else {
                // User has manually entered hours - mark as completed but keep their hours
                subtopic.completed = true;
            }
        });
    } else {
        // If syllabus topic not found, just mark subtopics as completed
        Object.keys(topic.subtopics).forEach(subtopicName => {
            topic.subtopics[subtopicName].completed = true;
        });
    }
} else if (nextStatus === 'not-started') {
    // Reset hours if going back to not-started, but only for auto-calculated hours
    // Don't reset user's manual entries
    Object.keys(topic.subtopics).forEach(subtopicName => {
        const subtopic = topic.subtopics[subtopicName];
        
        // Check if hours were auto-calculated (close to rounded weight-based value)
        if (syllabusData[subjectId]) {
            const syllabusTopic = syllabusData[subjectId].topics.find(t => t.name === topicName);
            if (syllabusTopic) {
                const subjectPlannedHours = userStudyPlan?.subjectHours?.[subjectId] || 0;
                const topicWeightage = syllabusTopic.weightage;
                const topicPlannedHours = (topicWeightage / 100) * subjectPlannedHours;
                
                const subtopicData = syllabusTopic.subtopics.find(s => s.name === subtopicName);
                if (subtopicData) {
                    const expectedHours = (subtopicData.weight / 100) * topicPlannedHours;
                    // If actual hours are within 10% of expected auto-calculated hours, reset them
                    if (Math.abs(subtopic.actualHours - expectedHours) < (expectedHours * 0.1)) {
                        subtopic.actualHours = 0;
                    }
                }
            }
        }
        
        subtopic.completed = false;
    });
}
```

1. DELETE this entire code block.

Step 2: Paste the NEW Fixed Code

Replace the deleted section with this NEW code:

```javascript
if (nextStatus === 'completed') {
    // Mark as completed but PRESERVE any existing manual hours
    Object.keys(topic.subtopics).forEach(subtopicName => {
        const subtopic = topic.subtopics[subtopicName];
        
        // If user hasn't entered any hours (0 or undefined), THEN calculate weightage-based hours
        if (!subtopic.actualHours || subtopic.actualHours === 0) {
            // Find topic data from syllabus to get weightage
            const subjectData = syllabusData[subjectId];
            const syllabusTopic = subjectData.topics.find(t => t.name === topicName);
            
            if (syllabusTopic) {
                // Calculate topic planned hours based on subject distribution
                const subjectPlannedHours = userStudyPlan?.subjectHours?.[subjectId] || 0;
                const topicWeightage = syllabusTopic.weightage;
                const topicPlannedHours = (topicWeightage / 100) * subjectPlannedHours;
                
                // Find subtopic data to get its weight
                const subtopicData = syllabusTopic.subtopics.find(s => s.name === subtopicName);
                if (subtopicData) {
                    const subtopicWeightage = subtopicData.weight;
                    // Calculate hours: subtopic weight * topic planned hours
                    subtopic.actualHours = (subtopicWeightage / 100) * topicPlannedHours;
                } else {
                    // Fallback: distribute equally
                    const numSubtopics = Object.keys(topic.subtopics).length;
                    subtopic.actualHours = topicPlannedHours / numSubtopics;
                }
            }
        }
        
        // Mark as completed (regardless of whether hours were auto-calculated or manual)
        subtopic.completed = true;
    });
} else if (nextStatus === 'not-started') {
    // When marking as not-started, ONLY reset hours that were auto-calculated
    // NEVER reset manually entered hours
    Object.keys(topic.subtopics).forEach(subtopicName => {
        const subtopic = topic.subtopics[subtopicName];
        
        // Only reset hours if they appear to be auto-calculated
        // Check if hours match a weightage-based calculation (within 5% tolerance)
        let shouldReset = true;
        
        const subjectData = syllabusData[subjectId];
        const syllabusTopic = subjectData.topics.find(t => t.name === topicName);
        
        if (syllabusTopic && subtopic.actualHours > 0) {
            const subjectPlannedHours = userStudyPlan?.subjectHours?.[subjectId] || 0;
            const topicWeightage = syllabusTopic.weightage;
            const topicPlannedHours = (topicWeightage / 100) * subjectPlannedHours;
            
            const subtopicData = syllabusTopic.subtopics.find(s => s.name === subtopicName);
            if (subtopicData) {
                const expectedHours = (subtopicData.weight / 100) * topicPlannedHours;
                const tolerance = expectedHours * 0.05; // 5% tolerance
                
                // If actual hours are close to expected auto-calculated hours, they're likely auto-calculated
                if (Math.abs(subtopic.actualHours - expectedHours) > tolerance) {
                    // Hours are NOT close to auto-calculated value - they're likely manual
                    shouldReset = false;
                }
            }
        }
        
        if (shouldReset) {
            subtopic.actualHours = 0;
        }
        subtopic.completed = false;
    });
}
```

Step 3: Update the saveAllProgress function (Optional but Recommended)

For even better manual hour tracking, find this part in saveAllProgress (around line 1900):

Look for this code:

```javascript
// Mark as manual entry if user changed from auto-calculated value
if (hours !== prevHours) {
    userProgress.subjects[subjectId].topics[topicName].subtopics[subtopicName].manualEntry = true;
    manualEntries++;
}
```

Add this line RIGHT AFTER the code above:

```javascript
// Also mark as manual entry if hours were just entered (prevHours was 0)
if (prevHours === 0 && hours > 0) {
    userProgress.subjects[subjectId].topics[topicName].subtopics[subtopicName].manualEntry = true;
}
```

What This Fix Does:

1. Priority to Manual Hours: When you mark a topic as "Completed", it will ONLY auto-calculate hours if you haven't entered ANY hours (0 or undefined).
2. Preserves Your Input: If you've entered ANY hours (even 0.5), it keeps YOUR manual hours.
3. Smart Reset: When marking as "Not Started", it only resets auto-calculated hours, not your manual entries.
4. Better Tracking: Added better tracking of manual vs auto-calculated hours.

How to Test:

1. Go to Subjects page
2. Enter manual hours for a subtopic (e.g., 3.5 hours)
3. Click the topic status to mark as "Completed"
4. Check that your 3.5 hours are preserved (not overwritten)
5. Mark as "Not Started" → Your 3.5 hours should remain
6. Mark as "Completed" again → Your 3.5 hours should remain

This fix ensures your manual hour entries are ALWAYS preserved and respected over auto-calculated weightage-based hours.
